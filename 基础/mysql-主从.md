### 主从原理

mysql主从同步过程

主从复制主要有三个线程

master : binlog dump 线程

salve： I/O 线程 ，sql 线程

master 一个 salve两个

1. 主节点 开启binlog ，主节点将所有变更记录到 binlog 中
2. 主节点的 binlog dump 线程发送去内容到从节点
3. 从节点 I/O 线程收到后，将其写入relay_log 文件中（中继日志）
4. 从节点的sql 线程读取relay_log 的内容对数据更新重放



注意：主节点使用的 binlog + position 偏移量来定位主从的位置，从节点会保存其接收到的偏移量

如果从节点发送宕机，会自动从这个 position 的位置发起同步



mysql 复制方式

异步的：这是默认的，主库不关心从库是否已经处理，这会产生一个问题，主库桂了，从库处理失败，从库升主库后，日志就丢失了

全同步：主库写入binlog后，强制同步到从库relay_log日志，等所有从库执行完成后才返回给客户端，但这明显性能有问题

半同步：主库写入binlog后，收到至少一个从库的确认完成后，就认为完成返回客户端

























